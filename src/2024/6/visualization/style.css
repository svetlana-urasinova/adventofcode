* {
  box-sizing: border-box;

  --frame-brown: #603417;
  --frame-gold: #f4b03e;
  --frame-white: #f9f9f9;
  --frame-dark: #335555;
  --frame-darker: #222222;

  --tile: #c27247;
  --tile-shadow: #63412e;
  --floor-shadow: #444444;
  --floor-visited: #a07054;
  --floor-guard: rgba(76, 175, 80, 0.5);
  --floor-guard-stopped: rgba(229, 57, 53, 0.5);
}

body {
  margin: 0;
}

main {
  --main-padding: 20px;
  align-items: center;
  display: flex;
  justify-content: center;
  height: 100vh;
  padding: var(--main-padding);
  width: 100vw;
}

.lab-container {
  --container-border-size: 10px;
  --container-outline-size: 4px;
  --container-size: calc(100vh - 2 * (var(--main-padding) + var(--container-outline-size)));
  --cell-size: calc((var(--container-size) - 2 * var(--container-border-size) - 52px) / 13);
  aspect-ratio: 1 / 1;
  background-image: url('./img/background.webp');
  background-repeat: no-repeat;
  background-size: 100%;
  border: var(--container-border-size) solid var(--frame-dark);
  height: var(--container-size);
  outline: var(--frame-darker) solid var(--container-outline-size);
  width: var(--container-size);
}

.lab-frame {
  background-color: var(--frame-gold);
  border: 2px solid var(--frame-white);
  outline: 4px solid var(--frame-brown);
  height: fit-content;
  margin: var(--cell-size) auto;
  padding: 7px;
  width: fit-content;
}

.lab {
  border: 2px solid var(--tile-shadow);
  display: grid;
  grid-template-columns: repeat(10, var(--cell-size));
  grid-template-rows: repeat(10, var(--cell-size));
  width: fit-content;

  & > div {
    background: var(--floor-shadow);
    position: relative;

    &::before {
      content: '';
      display: block;
      background: var(--tile);
      background-image: url('./img/tile.png');
      background-size: 100%;
      background-repeat: no-repeat;
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      z-index: 0;
    }

    &.visited {
      &::before {
        filter: grayscale(0.5) sepia(0.2);
      }
    }

    &:has(img) {
      &::before {
        filter: brightness(0.6) contrast(1.1);
      }
    }

    &:nth-child(even) {
      &::before {
        transform: rotate(90deg);
      }
    }

    > img {
      position: relative;
      object-fit: contain;
      height: 100%;
      width: 100%;
      z-index: 2;
    }

    #guard {
      background-color: var(--floor-guard);
      background-image: url('./img/guard/guard1.png');
      background-size: 100%;
      height: 100%;
      position: relative;
      width: 100%;
      z-index: 3;

      &.facing-right {
        transform: scaleX(-1);
      }

      &.walking {
        animation: walkingGuard 0.5s;
        animation-duration: 0.5s;
      }

      &.stopped {
        animation: stoppingGuard 0.5s infinite;
      }
    }
  }
}

@keyframes walkingGuard {
  0% {
    background-image: url('./img/guard/guard1.png');
  }
  50% {
    background-image: url('./img/guard/guard2.png');
  }
  75% {
    background-image: url('./img/guard/guard4.png');
  }
}

@keyframes stoppingGuard {
  0% {
    background-color: none;
  }

  50% {
    background-color: var(--floor-guard-stopped);
  }
}
